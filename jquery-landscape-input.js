// Generated by CoffeeScript 1.6.3
/*
# this plugin is a solution for fixing landscape mode input style
# author: blackbing at gmail dot com
*/


(function() {
  $.fn.landscapeInput = function() {
    var $this;
    $this = $(this);
    return $this.each(function(el) {
      var $el, $readyElement, handover, orientationchanged, placeholder, tagName;
      $el = $(this);
      tagName = $el.prop('tagName');
      placeholder = $el.prop('placeholder');
      $readyElement = $("<" + tagName + " placeholder='" + placeholder + "' style='position:absolute;left:0;top:0;z-index:999999999999;width:100%;height:100%;font-size:18px;display:none;'>");
      $el.data('$readyElement', $readyElement);
      handover = function(orientation) {
        var $focusElement, value;
        if (orientation == null) {
          orientation = 'landscape';
        }
        $focusElement = $el;
        $readyElement = $focusElement.data('$readyElement');
        if (orientation === 'landscape') {
          value = $focusElement.val();
          $focusElement.blur();
          return $readyElement.val(value).prop('selectionStart', value.length).show().focus();
        } else if (orientation === 'portrait') {
          value = $readyElement.val();
          $readyElement.hide().remove();
          return $focusElement.val(value).prop('selectionStart', value.length).focus();
        }
      };
      orientationchanged = function($focusElement) {
        var orientation;
        orientation = Math.abs(window.orientation);
        $readyElement = $focusElement.data('$readyElement');
        $readyElement.appendTo('body');
        if (orientation === 90) {
          return handover('landscape');
        } else {
          return handover('portrait');
        }
      };
      return $el.on('focusin', function($event) {
        var orientation;
        $el = $(this);
        orientation = Math.abs(window.orientation);
        if (orientation === 90) {
          orientationchanged($el);
        }
        if (!$el.data('bind-orientation')) {
          $(window).on('orientationchange.focusin', _.debounce((function() {
            return orientationchanged($el);
          }), 300));
          $el.data('bind-orientation', true);
        }
        return $event.preventDefault();
      });
    });
  };

}).call(this);
